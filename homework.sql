create table if not exists pc
(
    code  integer not null
        constraint pc_pk
            primary key,
    model char(10),
    speed integer,
    ram   integer,
    hd    integer,
    cd    char(5),
    price double precision
);
delete from pc;
insert into pc values
(1,'1201',500,32,4,900,1000),
(2,'1202',700,32,9,200,300),
(3,'1203',300,64,2,800,800),
(4,'1204',100,128,6,500,300),
(5,'1205',100,32,3,300,800),
(6,'1206',500,16,6,500,300),
(7,'1207',700,16,7,100,500),
(8,'1208',400,16,4,100,1000),
(9,'1209',800,16,1,200,700),
(10,'1210',900,16,1,500,500),
(11,'1211',800,128,6,100,600),
(12,'1212',200,128,4,500,300),
(13,'1213',900,16,5,400,200),
(14,'1214',800,16,6,700,100),
(15,'1215',100,128,3,100,800),
(16,'1216',100,128,3,900,600),
(17,'1217',900,32,5,800,100),
(18,'1218',800,32,4,400,700),
(19,'1219',300,128,2,300,900),
(20,'1220',500,64,3,200,800),
(21,'1221',500,16,3,1000,700),
(22,'1222',800,16,7,1100,700),
(23,'1223',900,128,1,300,200),
(24,'1224',500,16,9,400,300),
(25,'1225',100,64,1,900,900),
(26,'1226',400,32,6,300,1000),
(27,'1227',100,64,8,800,800),
(28,'1228',400,16,9,100,300),
(29,'1229',700,32,7,500,800),
(30,'1230',300,16,4,700,1000),
(31,'1231',900,128,8,800,600),
(32,'1232',700,64,6,1000,600),
(33,'1233',400,32,5,800,700),
(34,'1234',800,16,7,800,100),
(35,'1235',800,32,7,800,900),
(36,'1236',200,16,3,400,600),
(37,'1237',400,32,6,600,700),
(38,'1238',200,16,9,200,1000),
(39,'1239',800,64,4,100,700),
(40,'1240',600,16,4,600,600),
(41,'1241',600,32,9,500,500),
(42,'1242',200,128,2,1100,800),
(43,'1243',100,32,2,1100,500),
(44,'1244',400,32,8,200,1000),
(45,'1245',900,16,9,300,900),
(46,'1246',100,128,3,900,1100),
(47,'1247',700,16,1,900,400),
(48,'1248',600,16,1,200,200),
(49,'1249',800,64,4,700,900),
(50,'1250',900,64,4,400,700),
(51,'1251',800,32,8,900,700),
(52,'1252',100,16,8,500,1000),
(53,'1253',100,64,4,900,600),
(54,'1254',700,16,7,700,700),
(55,'1255',900,64,5,600,400),
(56,'1256',600,16,3,300,600),
(57,'1257',800,64,8,900,600),
(58,'1258',600,32,2,700,700),
(59,'1259',400,64,5,100,600),
(60,'1260',200,64,5,800,800),
(61,'1261',100,32,2,1100,100),
(62,'1262',200,128,4,1100,300),
(63,'1263',700,16,9,300,500),
(64,'1264',500,32,5,700,400),
(65,'1265',400,64,4,1000,400),
(66,'1266',700,32,6,500,300),
(67,'1267',800,64,7,700,600),
(68,'1268',400,16,3,700,400),
(69,'1269',800,16,8,500,400),
(70,'1270',900,16,7,400,800),
(71,'1271',700,16,6,700,1100),
(72,'1272',200,128,6,500,300),
(73,'1273',800,32,4,1000,200),
(74,'1274',900,128,6,900,300),
(75,'1275',500,64,6,1100,1000),
(76,'1276',600,64,5,300,900),
(77,'1277',900,128,2,300,300),
(78,'1278',200,128,5,800,1000),
(79,'1279',800,16,1,100,200),
(80,'1280',700,32,3,300,300),
(81,'1281',900,128,2,1100,1000),
(82,'1282',700,32,6,1000,900),
(83,'1283',400,32,6,100,200),
(84,'1284',400,32,6,1000,500),
(85,'1285',500,128,9,800,1000),
(86,'1286',700,64,4,500,500),
(87,'1287',200,64,9,1000,800),
(88,'1288',300,64,2,800,300),
(89,'1289',800,64,8,200,400),
(90,'1290',200,32,8,800,100),
(91,'1291',500,32,3,600,1100),
(92,'1292',700,32,2,1000,500),
(93,'1293',900,64,4,100,300),
(94,'1294',700,32,6,700,400),
(95,'1295',800,16,1,700,800),
(96,'1296',400,64,9,300,100),
(97,'1297',200,128,6,1100,200),
(98,'1298',600,128,2,200,200),
(99,'1299',300,32,6,500,600),
(100,'1300',600,128,2,300,700);

create table if not exists laptop
(
    code   integer not null
        constraint laptop_pk
            primary key,
    model  char(10),
    speed  integer,
    ram    integer,
    hd     double precision,
    screen double precision,
    price  double precision
);
delete from laptop;
insert into laptop values
(1,'1201',400,4,2,400,300),
(2,'1202',700,32,2,600,500),
(3,'1203',300,4,9,800,1100),
(4,'1204',700,4,4,800,500),
(5,'1205',100,8,9,100,500),
(6,'1206',400,16,8,1000,1100),
(7,'1207',900,16,6,700,1100),
(8,'1208',400,8,9,900,200),
(9,'1209',600,2,9,700,1100),
(10,'1210',100,8,2,1100,1000),
(11,'1211',500,4,9,300,500),
(12,'1212',900,32,9,800,400),
(13,'1213',900,2,8,200,200),
(14,'1214',700,8,8,500,100),
(15,'1215',700,16,5,200,500),
(16,'1216',900,2,2,700,1100),
(17,'1217',500,4,9,1100,200),
(18,'1218',800,16,7,300,400),
(19,'1219',300,32,7,800,100),
(20,'1220',900,2,8,400,400),
(21,'1221',900,32,2,600,400),
(22,'1222',400,4,7,900,100),
(23,'1223',500,8,5,100,500),
(24,'1224',800,32,6,900,1100),
(25,'1225',700,16,8,800,600),
(26,'1226',400,32,7,200,600),
(27,'1227',100,16,1,600,1100),
(28,'1228',600,32,9,100,900),
(29,'1229',200,16,7,1100,100),
(30,'1230',600,2,3,400,400),
(31,'1231',200,2,1,800,200),
(32,'1232',200,8,3,300,400),
(33,'1233',300,32,8,400,300),
(34,'1234',700,32,2,1100,700),
(35,'1235',400,32,1,600,300),
(36,'1236',400,8,3,700,700),
(37,'1237',400,32,4,500,200),
(38,'1238',100,16,3,800,200),
(39,'1239',900,16,3,600,200),
(40,'1240',900,4,9,500,400),
(41,'1241',600,2,8,300,200),
(42,'1242',900,2,5,400,900),
(43,'1243',300,32,5,200,500),
(44,'1244',800,8,8,600,900),
(45,'1245',900,16,5,200,300),
(46,'1246',700,16,9,900,1000),
(47,'1247',200,8,7,800,800),
(48,'1248',800,4,5,600,900),
(49,'1249',600,8,2,800,500),
(50,'1250',400,4,9,500,600),
(51,'1251',900,8,2,100,200),
(52,'1252',900,16,7,800,500),
(53,'1253',200,8,4,1000,300),
(54,'1254',500,4,5,900,800),
(55,'1255',400,32,5,600,500),
(56,'1256',200,8,7,500,1100),
(57,'1257',800,2,5,100,600),
(58,'1258',500,16,5,400,200),
(59,'1259',200,16,3,200,200),
(60,'1260',100,2,3,300,1000),
(61,'1261',200,16,1,700,400),
(62,'1262',400,4,9,500,800),
(63,'1263',800,2,8,700,1100),
(64,'1264',800,4,5,900,500),
(65,'1265',900,16,5,300,1100),
(66,'1266',500,8,5,500,600),
(67,'1267',200,32,1,200,300),
(68,'1268',800,4,7,1100,300),
(69,'1269',600,8,3,700,500),
(70,'1270',900,32,9,700,700),
(71,'1271',200,8,6,800,600),
(72,'1272',700,32,8,1100,300),
(73,'1273',400,4,5,200,300),
(74,'1274',500,4,9,400,800),
(75,'1275',700,4,5,500,600),
(76,'1276',100,2,3,600,900),
(77,'1277',400,16,1,200,400),
(78,'1278',700,2,2,600,1100),
(79,'1279',400,16,8,300,600),
(80,'1280',100,32,7,1000,200),
(81,'1281',700,2,1,500,100),
(82,'1282',200,8,6,900,1000),
(83,'1283',400,4,5,800,900),
(84,'1284',900,32,1,900,1100),
(85,'1285',100,4,2,100,400),
(86,'1286',600,4,4,100,900),
(87,'1287',300,4,4,600,400),
(88,'1288',900,2,4,600,600),
(89,'1289',800,2,8,300,200),
(90,'1290',800,16,9,100,200),
(91,'1291',200,8,5,500,800),
(92,'1292',900,16,8,400,600),
(93,'1293',800,4,2,200,100),
(94,'1294',500,2,5,300,800),
(95,'1295',100,2,6,600,700),
(96,'1296',500,16,5,300,300),
(97,'1297',700,2,2,600,1000),
(98,'1298',900,16,5,800,900),
(99,'1299',500,16,6,800,300),
(100,'1300',100,32,4,900,1000);

create table if not exists printer
(
    code  integer not null
        constraint printer_pk
            primary key,
    model char(10),
    color char,
    price double precision,
    type  char(10)
);
delete from printer;
insert into printer (code,model,color,type,price) values
(1,'1101','y','laser',400),
(2,'1102','y','laser',700),
(3,'1103','y','jet',700),
(4,'1104','y','matrix',1100),
(5,'1105','n','laser',400),
(6,'1106','y','matrix',500),
(7,'1107','y','matrix',300),
(8,'1108','y','jet',1000),
(9,'1109','y','matrix',600),
(10,'1110','n','laser',500),
(11,'1111','y','jet',100),
(12,'1112','n','laser',400),
(13,'1113','y','laser',900),
(14,'1114','y','matrix',300),
(15,'1115','n','matrix',300),
(16,'1116','n','laser',200),
(17,'1117','n','laser',500),
(18,'1118','n','matrix',900),
(19,'1119','n','laser',800),
(20,'1120','n','jet',1000),
(21,'1121','y','jet',200),
(22,'1122','y','jet',100),
(23,'1123','n','matrix',300),
(24,'1124','y','laser',600),
(25,'1125','y','laser',200),
(26,'1126','n','matrix',100),
(27,'1127','y','jet',1000),
(28,'1128','n','jet',200),
(29,'1129','n','matrix',500),
(30,'1130','y','matrix',400),
(31,'1131','n','matrix',700),
(32,'1132','y','laser',500),
(33,'1133','n','matrix',500),
(34,'1134','n','matrix',1100),
(35,'1135','n','laser',500),
(36,'1136','y','jet',600),
(37,'1137','y','jet',600),
(38,'1138','n','matrix',500),
(39,'1139','n','matrix',100),
(40,'1140','y','jet',900),
(41,'1141','y','matrix',400),
(42,'1142','y','matrix',1100),
(43,'1143','n','laser',900),
(44,'1144','n','jet',300),
(45,'1145','y','laser',900),
(46,'1146','n','jet',800),
(47,'1147','n','jet',800),
(48,'1148','y','matrix',800),
(49,'1149','n','laser',200),
(50,'1150','y','matrix',500),
(51,'1151','n','matrix',900),
(52,'1152','y','jet',500),
(53,'1153','n','matrix',1100),
(54,'1154','y','jet',1100),
(55,'1155','n','jet',300),
(56,'1156','y','matrix',300),
(57,'1157','n','jet',500),
(58,'1158','y','matrix',1100),
(59,'1159','n','laser',900),
(60,'1160','n','laser',800),
(61,'1161','n','matrix',400),
(62,'1162','n','jet',500),
(63,'1163','n','laser',1100),
(64,'1164','n','jet',400),
(65,'1165','y','laser',1000),
(66,'1166','y','laser',500),
(67,'1167','y','jet',900),
(68,'1168','y','matrix',600),
(69,'1169','y','jet',100),
(70,'1170','n','laser',600),
(71,'1171','n','matrix',800),
(72,'1172','n','jet',800),
(73,'1173','n','matrix',200),
(74,'1174','y','jet',400),
(75,'1175','n','laser',500),
(76,'1176','y','jet',1100),
(77,'1177','n','laser',600),
(78,'1178','y','jet',1000),
(79,'1179','y','matrix',800),
(80,'1180','y','matrix',600),
(81,'1181','y','laser',900),
(82,'1182','n','laser',1000),
(83,'1183','y','jet',100),
(84,'1184','y','matrix',500),
(85,'1185','n','jet',1100),
(86,'1186','n','matrix',200),
(87,'1187','y','matrix',200),
(88,'1188','y','jet',800),
(89,'1189','y','matrix',200),
(90,'1190','y','matrix',400),
(91,'1191','y','matrix',400),
(92,'1192','n','jet',900),
(93,'1193','n','jet',800),
(94,'1194','n','jet',400),
(95,'1195','n','laser',100),
(96,'1196','y','matrix',200),
(97,'1197','y','laser',900),
(98,'1198','y','jet',1000),
(99,'1199','n','laser',100),
(100,'1200','y','jet',500);

create table if not exists product
(
    maker char(2),
    model char(10) not null
        constraint product_pk
            primary key,
    type  char(10)
);
create unique index product_model_uindex
    on product (model);
delete from product;
insert into product values
('EE', '1001','pc'),
('EA', '1002','pc'),
('CE', '1003','pc'),
('BF', '1004','pc'),
('DF', '1005','pc'),
('FD', '1006','pc'),
('DB', '1007','pc'),
('AD', '1008','pc'),
('BE', '1009','pc'),
('BA', '1010','pc'),
('EE', '1011','pc'),
('BA', '1012','pc'),
('FE', '1013','pc'),
('DA', '1014','pc'),
('EB', '1015','pc'),
('BD', '1016','pc'),
('AD', '1017','pc'),
('CF', '1018','pc'),
('BE', '1019','pc'),
('CC', '1020','pc'),
('BE', '1021','pc'),
('AB', '1022','pc'),
('BA', '1023','pc'),
('CF', '1024','pc'),
('FE', '1025','pc'),
('EB', '1026','pc'),
('BA', '1027','pc'),
('BC', '1028','pc'),
('FA', '1029','pc'),
('FF', '1030','pc'),
('AA', '1031','pc'),
('BE', '1032','pc'),
('FD', '1033','pc'),
('FB', '1034','pc'),
('DD', '1035','pc'),
('BA', '1036','pc'),
('CC', '1037','pc'),
('AD', '1038','pc'),
('BF', '1039','pc'),
('AD', '1040','pc'),
('DC', '1041','pc'),
('FB', '1042','pc'),
('AB', '1043','pc'),
('FD', '1044','pc'),
('BC', '1045','pc'),
('BF', '1046','pc'),
('BC', '1047','pc'),
('FF', '1048','pc'),
('BC', '1049','pc'),
('EF', '1050','pc'),
('FC', '1051','pc'),
('DC', '1052','pc'),
('CE', '1053','pc'),
('FC', '1054','pc'),
('DB', '1055','pc'),
('BD', '1056','pc'),
('CF', '1057','pc'),
('EC', '1058','pc'),
('BE', '1059','pc'),
('AD', '1060','pc'),
('CF', '1061','pc'),
('FD', '1062','pc'),
('FD', '1063','pc'),
('AE', '1064','pc'),
('DD', '1065','pc'),
('AB', '1066','pc'),
('EA', '1067','pc'),
('EC', '1068','pc'),
('BB', '1069','pc'),
('AF', '1070','pc'),
('CC', '1071','pc'),
('FA', '1072','pc'),
('CC', '1073','pc'),
('BD', '1074','pc'),
('CA', '1075','pc'),
('EF', '1076','pc'),
('AE', '1077','pc'),
('CC', '1078','pc'),
('EB', '1079','pc'),
('DE', '1080','pc'),
('BB', '1081','pc'),
('BE', '1082','pc'),
('FB', '1083','pc'),
('BE', '1084','pc'),
('DD', '1085','pc'),
('DC', '1086','pc'),
('CE', '1087','pc'),
('FF', '1088','pc'),
('CE', '1089','pc'),
('CB', '1090','pc'),
('FE', '1091','pc'),
('CE', '1092','pc'),
('DC', '1093','pc'),
('CB', '1094','pc'),
('FC', '1095','pc'),
('EF', '1096','pc'),
('DD', '1097','pc'),
('BB', '1098','pc'),
('BF', '1099','pc'),
('CD', '1100','pc'),
('DD', '1101','printer'),
('EE', '1102','printer'),
('EC', '1103','printer'),
('BA', '1104','printer'),
('BE', '1105','printer'),
('CD', '1106','printer'),
('BD', '1107','printer'),
('AB', '1108','printer'),
('ED', '1109','printer'),
('FE', '1110','printer'),
('DD', '1111','printer'),
('BE', '1112','printer'),
('DA', '1113','printer'),
('BC', '1114','printer'),
('AD', '1115','printer'),
('BE', '1116','printer'),
('DF', '1117','printer'),
('EA', '1118','printer'),
('AC', '1119','printer'),
('AC', '1120','printer'),
('DA', '1121','printer'),
('EA', '1122','printer'),
('AD', '1123','printer'),
('EC', '1124','printer'),
('CF', '1125','printer'),
('EC', '1126','printer'),
('AD', '1127','printer'),
('EC', '1128','printer'),
('BB', '1129','printer'),
('BA', '1130','printer'),
('ED', '1131','printer'),
('DE', '1132','printer'),
('FC', '1133','printer'),
('EB', '1134','printer'),
('EB', '1135','printer'),
('AA', '1136','printer'),
('CF', '1137','printer'),
('DB', '1138','printer'),
('FC', '1139','printer'),
('AE', '1140','printer'),
('ED', '1141','printer'),
('DB', '1142','printer'),
('BD', '1143','printer'),
('CF', '1144','printer'),
('CE', '1145','printer'),
('AF', '1146','printer'),
('CD', '1147','printer'),
('BD', '1148','printer'),
('DE', '1149','printer'),
('FB', '1150','printer'),
('BA', '1151','printer'),
('DC', '1152','printer'),
('CE', '1153','printer'),
('EB', '1154','printer'),
('AD', '1155','printer'),
('DC', '1156','printer'),
('CD', '1157','printer'),
('FF', '1158','printer'),
('DF', '1159','printer'),
('BF', '1160','printer'),
('AC', '1161','printer'),
('FF', '1162','printer'),
('CA', '1163','printer'),
('FE', '1164','printer'),
('ED', '1165','printer'),
('CD', '1166','printer'),
('ED', '1167','printer'),
('EB', '1168','printer'),
('FC', '1169','printer'),
('EE', '1170','printer'),
('DE', '1171','printer'),
('CC', '1172','printer'),
('EC', '1173','printer'),
('CC', '1174','printer'),
('FC', '1175','printer'),
('FB', '1176','printer'),
('CD', '1177','printer'),
('BF', '1178','printer'),
('DC', '1179','printer'),
('FB', '1180','printer'),
('CD', '1181','printer'),
('DA', '1182','printer'),
('CF', '1183','printer'),
('DE', '1184','printer'),
('BC', '1185','printer'),
('FA', '1186','printer'),
('EC', '1187','printer'),
('AF', '1188','printer'),
('FC', '1189','printer'),
('AC', '1190','printer'),
('ED', '1191','printer'),
('CB', '1192','printer'),
('BE', '1193','printer'),
('BC', '1194','printer'),
('FB', '1195','printer'),
('EB', '1196','printer'),
('CD', '1197','printer'),
('BD', '1198','printer'),
('CF', '1199','printer'),
('FD', '1200','printer'),
('FF', '1201','laptop'),
('CE', '1202','laptop'),
('EF', '1203','laptop'),
('EF', '1204','laptop'),
('CC', '1205','laptop'),
('AD', '1206','laptop'),
('DB', '1207','laptop'),
('EE', '1208','laptop'),
('DE', '1209','laptop'),
('DB', '1210','laptop'),
('AA', '1211','laptop'),
('AC', '1212','laptop'),
('CB', '1213','laptop'),
('FD', '1214','laptop'),
('CB', '1215','laptop'),
('BD', '1216','laptop'),
('FA', '1217','laptop'),
('CF', '1218','laptop'),
('CF', '1219','laptop'),
('BC', '1220','laptop'),
('AB', '1221','laptop'),
('FE', '1222','laptop'),
('EE', '1223','laptop'),
('CC', '1224','laptop'),
('CE', '1225','laptop'),
('FC', '1226','laptop'),
('BD', '1227','laptop'),
('DA', '1228','laptop'),
('FC', '1229','laptop'),
('AF', '1230','laptop'),
('AE', '1231','laptop'),
('AB', '1232','laptop'),
('BF', '1233','laptop'),
('DB', '1234','laptop'),
('ED', '1235','laptop'),
('EA', '1236','laptop'),
('DD', '1237','laptop'),
('DE', '1238','laptop'),
('BA', '1239','laptop'),
('FD', '1240','laptop'),
('AE', '1241','laptop'),
('AE', '1242','laptop'),
('EE', '1243','laptop'),
('DB', '1244','laptop'),
('CE', '1245','laptop'),
('DD', '1246','laptop'),
('FC', '1247','laptop'),
('AB', '1248','laptop'),
('FB', '1249','laptop'),
('ED', '1250','laptop'),
('EB', '1251','laptop'),
('BB', '1252','laptop'),
('AD', '1253','laptop'),
('BD', '1254','laptop'),
('DC', '1255','laptop'),
('CB', '1256','laptop'),
('FC', '1257','laptop'),
('AE', '1258','laptop'),
('BF', '1259','laptop'),
('DE', '1260','laptop'),
('FF', '1261','laptop'),
('FA', '1262','laptop'),
('AD', '1263','laptop'),
('DE', '1264','laptop'),
('FE', '1265','laptop'),
('FD', '1266','laptop'),
('BB', '1267','laptop'),
('CA', '1268','laptop'),
('EF', '1269','laptop'),
('AA', '1270','laptop'),
('FC', '1271','laptop'),
('FD', '1272','laptop'),
('BE', '1273','laptop'),
('AB', '1274','laptop'),
('DC', '1275','laptop'),
('DC', '1276','laptop'),
('DC', '1277','laptop'),
('CD', '1278','laptop'),
('EA', '1279','laptop'),
('CB', '1280','laptop'),
('AA', '1281','laptop'),
('CC', '1282','laptop'),
('BF', '1283','laptop'),
('BE', '1284','laptop'),
('AC', '1285','laptop'),
('AF', '1286','laptop'),
('CD', '1287','laptop'),
('EE', '1288','laptop'),
('CD', '1289','laptop'),
('FD', '1290','laptop'),
('EB', '1291','laptop'),
('FF', '1292','laptop'),
('BB', '1293','laptop'),
('FB', '1294','laptop'),
('EA', '1295','laptop'),
('DF', '1296','laptop'),
('CD', '1297','laptop'),
('DA', '1298','laptop'),
('FB', '1299','laptop'),
('DF', '1300','laptop');


-- Task 1. A
select model, price from (select model, price,
                      max(price) over () as max_price
               from printer) as t1
where t1.price = t1.max_price;


-- Task 1. B
select avg(speed) from pc;


-- Task 1. C
select p.maker, p.is_selling_laptop
from (select p.maker,
      p.type,
      max(case when p.type = 'laptop' then 1 else 0 end) over(partition by maker) as is_selling_laptop
      from product as p) as p
where p.is_selling_laptop = 0
group by p.maker, p.is_selling_laptop;


-- Task 2.
insert into pc(code, model, speed, ram, hd, cd, price)
(select code + 100, model, speed, ram, hd, cd, price from pc);


-- Task 3.
delete from pc where code in(
select code from (select code,
                      row_number() over(partition by model, speed, ram, hd, cd, price) as rn
               from pc) as t1
where rn > 1);


-- Task 4.
alter table printer
    rename column color to color_type;

alter table printer
    alter column color_type type char(10) using color_type::char(10);


-- Task 5
select * from
    (select * from pc
    union
    select code, model, speed, ram, hd, cast(screen as char(10)), price from laptop) as t1
where ram = 64 and price > 500